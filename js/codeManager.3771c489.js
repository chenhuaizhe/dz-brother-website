(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["codeManager"],{"322a":function(e,t,l){"use strict";l.r(t);var a=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("d2-container",[l("template",{slot:"header"},[l("div",{staticClass:"filter-container"},[l("el-select",{staticClass:"filter-item",staticStyle:{"margin-right":"10px"},attrs:{size:"small",placeholder:"请选择数据源"},on:{change:e.handleFilter},model:{value:e.listQuery.dbName,callback:function(t){e.$set(e.listQuery,"dbName",t)},expression:"listQuery.dbName"}},e._l(e.dbsOptions,(function(e){return l("el-option",{key:e,attrs:{label:e,value:e}})})),1),l("el-input",{staticClass:"filter-item",staticStyle:{width:"200px","margin-right":"10px"},attrs:{size:"small",placeholder:"表名"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilter(t)}},model:{value:e.listQuery.tableName,callback:function(t){e.$set(e.listQuery,"tableName",t)},expression:"listQuery.tableName"}}),l("el-button",{staticClass:"filter-item",attrs:{size:"small",type:"primary",icon:"search"},on:{click:e.handleFilter}},[e._v("搜索")]),l("el-button",{staticClass:"filter-item",attrs:{size:"small",type:"primary"},on:{click:e.handlerGenerator}},[e._v("生成代码")])],1)]),l("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.list,size:"small",stripe:"","highlight-current-row":""},on:{select:e.handlerSelect}},[l("el-table-column",{attrs:{type:"selection",width:"55"}}),l("el-table-column",{attrs:{align:"center",label:"表名"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("span",[e._v(e._s(t.row.tableName))])]}}])}),l("el-table-column",{attrs:{align:"center",label:"表备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("span",[e._v(e._s(t.row.tableComment))])]}}])}),l("el-table-column",{attrs:{width:"200px",align:"center",label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("span",[e._v(e._s(t.row.createTime))])]}}])})],1),l("template",{slot:"footer"},[l("div",{directives:[{name:"show",rawName:"v-show",value:!e.listLoading,expression:"!listLoading"}],staticClass:"pagination-container"},[l("el-pagination",{attrs:{"current-page":e.listQuery.page,"page-sizes":[10,20,30,50],"page-size":e.listQuery.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){return e.$set(e.listQuery,"page",t)},"update:current-page":function(t){return e.$set(e.listQuery,"page",t)}}})],1)]),l("el-dialog",{attrs:{title:e.dialogProjectName,visible:e.dialogProjectFormVisible},on:{"update:visible":function(t){e.dialogProjectFormVisible=t}}},[l("el-form",{ref:"buildProjectForm",attrs:{model:e.buildProjectForm,rules:e.buildProjectFormRules,"label-width":"100px"}},[l("el-form-item",{attrs:{label:"package",prop:"package"}},[l("el-input",{attrs:{placeholder:"请输入代码包路径"},model:{value:e.buildProjectForm.package,callback:function(t){e.$set(e.buildProjectForm,"package",t)},expression:"buildProjectForm.package"}})],1),l("el-form-item",{attrs:{label:"移除表前缀",prop:"tablePrefix"}},[l("el-input",{attrs:{placeholder:"请输入移除表前缀"},model:{value:e.buildProjectForm.tablePrefix,callback:function(t){e.$set(e.buildProjectForm,"tablePrefix",t)},expression:"buildProjectForm.tablePrefix"}})],1),l("el-form-item",{attrs:{label:"前端模块名"}},[l("el-input",{attrs:{placeholder:"请输入前端模块名"},model:{value:e.buildProjectForm.mainModule,callback:function(t){e.$set(e.buildProjectForm,"mainModule",t)},expression:"buildProjectForm.mainModule"}})],1),l("el-form-item",{attrs:{label:"作者"}},[l("el-input",{attrs:{placeholder:"请输入作者"},model:{value:e.buildProjectForm.author,callback:function(t){e.$set(e.buildProjectForm,"author",t)},expression:"buildProjectForm.author"}})],1)],1),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){return e.cancel("buildProjectForm")}}},[e._v("取 消")]),l("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.buildProject("buildProjectForm")}}},[e._v("确 定")])],1)],1)],2)},i=[],r=l("9bd2");function o(e){return Object(r["a"])({url:"/api/code/generator/page",method:"get",params:e})}function n(){return Object(r["a"])({url:"/api/code/generator/dbs",method:"get"})}var s=l("c276"),c={name:"tableManager",data:function(){return{list:null,total:null,listLoading:!0,listQuery:{page:1,limit:20,crtName:void 0},buildProjectForm:{package:void 0,tablePrefix:"",author:"",mainModule:""},buildProjectFormRules:{package:[{required:!0,message:"请输入合法的包路径",trigger:"blur"},{min:3,message:"长度在 3个字符以上",trigger:"blur"}]},dialogFormVisible:!1,dialogStatus:"",tableKey:0,tables:[],dialogProjectName:"代码生成",dialogProjectFormVisible:!1,dbsOptions:[]}},created:function(){this.getDbs(),this.getList()},methods:{getList:function(){var e=this;this.listLoading=!0,o(this.listQuery).then((function(t){e.list=t.rows,e.total=t.total,e.listLoading=!1}))},getDbs:function(){var e=this;n().then((function(t){e.dbsOptions=t.rows,e.listQuery.dbName=t.rows[0]}))},handleFilter:function(){this.getList()},handleSizeChange:function(e){this.listQuery.limit=e,this.getList()},handleCurrentChange:function(e){this.listQuery.page=e,this.getList()},handlerGenerator:function(){this.dialogProjectFormVisible=!0},handlerSelect:function(e,t){for(var l=!0,a=0;a<e.length;a++)if(e[a].tableName===t.tableName){this.tables.push(t.tableName),l=!1;break}if(l){for(var i=[],r=0;r<this.tables.length;r++)this.tables[r]!==t.tableName&&i.push(this.tables[r]);this.tables=i}},cancel:function(e){this.dialogProjectFormVisible=!1;var t=this.$refs;t[e].resetFields()},buildProject:function(e){var t=this,l=this.$refs;l[e].validate((function(e){if(e){var l=document.createElement("a");l.style.display="none",l.target="_blank",l.href="http://holer.cc:50631/api/code/generator/build?tables="+t.tables.concat()+"&author="+t.buildProjectForm.author+"&path="+t.buildProjectForm.package+"&mainModule="+t.buildProjectForm.mainModule+"&dbName="+t.listQuery.dbName+"&tablePrefix="+t.buildProjectForm.tablePrefix+"&token="+s["a"].cookies.get("token"),document.body.appendChild(l),l.click(),URL.revokeObjectURL(l.href),document.body.removeChild(l)}}))}}},u=c,d=l("2877"),m=Object(d["a"])(u,a,i,!1,null,null,null);t["default"]=m.exports}}]);
//# sourceMappingURL=codeManager.3771c489.js.map