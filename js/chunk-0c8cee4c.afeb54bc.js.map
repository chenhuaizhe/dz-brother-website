{"version":3,"sources":["webpack:///./src/api/admin/menu/index.js","webpack:///./src/pages/admin/group/components/groupAuthority.vue?12c7","webpack:///src/pages/admin/group/components/groupAuthority.vue","webpack:///./src/pages/admin/group/components/groupAuthority.vue?e7a5","webpack:///./src/pages/admin/group/components/groupAuthority.vue","webpack:///./src/api/admin/element/index.js"],"names":["fetchTree","query","fetch","url","method","params","addObj","obj","data","getObj","id","delObj","putObj","render","_vm","this","_h","$createElement","_c","_self","attrs","on","update","_v","_e","staticStyle","model","value","callback","$$v","filterText","expression","ref","staticClass","getTreeNodeKey","treeData","defaultProps","filterNode","getNodeData","list","handleSelectionChange","scopedSlots","_u","key","fn","scope","_s","row","code","type","name","uri","staticRenderFns","props","groupId","default","total","listQuery","undefined","children","label","groupManager_menu","groupManager_element","watch","$refs","menuTree","filter","val","created","getList","hasPermissions","computed","methods","indexOf","menuId","console","log","toggle","currentId","showElement","node","i","elementId","flag","$emit","ids","push","nodes","menuTrees","join","title","message","duration","initAuthoritys","result","component","page"],"mappings":"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","file":"js/chunk-0c8cee4c.afeb54bc.js","sourcesContent":["import fetch from '@/plugin/axios'\n\n\nexport function fetchTree(query) {\n  return fetch({\n    url: '/api/admin/menu/tree',\n    method: 'get',\n    params: query\n  });\n}\n\nexport function fetchAll() {\n  return fetch({\n    url: '/api/admin/menu/all',\n    method: 'get'\n  });\n}\nexport function addObj(obj) {\n  return fetch({\n    url: '/api/admin/menu',\n    method: 'post',\n    data: obj\n  });\n}\n\nexport function getObj(id) {\n  return fetch({\n    url: '/api/admin/menu/' + id,\n    method: 'get'\n  })\n}\n\nexport function delObj(id) {\n  return fetch({\n    url: '/api/admin/menu/' + id,\n    method: 'delete'\n  })\n}\n\nexport function putObj(id, obj) {\n  return fetch({\n    url: '/api/admin/menu/' + id,\n    method: 'put',\n    data: obj\n  })\n}\n\n\n\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-row',[_c('el-col',{attrs:{\"span\":24}},[(_vm.groupManager_menu)?_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.update}},[_vm._v(\"保存\")]):_vm._e()],1),_c('el-col',{staticStyle:{\"margin-top\":\"15px\"},attrs:{\"span\":8}},[_c('el-input',{attrs:{\"placeholder\":\"输入关键字进行过滤\"},model:{value:(_vm.filterText),callback:function ($$v) {_vm.filterText=$$v},expression:\"filterText\"}}),_c('el-tree',{ref:\"menuTree\",staticClass:\"filter-tree\",attrs:{\"check-strictly\":\"\",\"node-key\":_vm.getTreeNodeKey,\"data\":_vm.treeData,\"show-checkbox\":\"\",\"node-key\":\"id\",\"highlight-current\":\"\",\"props\":_vm.defaultProps,\"filter-node-method\":_vm.filterNode,\"default-expand-all\":\"\"},on:{\"node-click\":_vm.getNodeData}})],1),_c('el-col',{staticStyle:{\"margin-top\":\"15px\"},attrs:{\"span\":16}},[_c('el-table',{ref:\"elementTable\",staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.list,\"border\":\"\",\"fit\":\"\",\"highlight-current-row\":\"\"},on:{\"select\":_vm.handleSelectionChange}},[(_vm.groupManager_element)?_c('el-table-column',{attrs:{\"type\":\"selection\",\"width\":\"55\"}}):_vm._e(),_c('el-table-column',{attrs:{\"width\":\"200px\",\"align\":\"center\",\"label\":\"资源编码\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('span',[_vm._v(\"\\r\\n        \"+_vm._s(scope.row.code))])]}}])}),_c('el-table-column',{attrs:{\"width\":\"200px\",\"align\":\"center\",\"label\":\"资源类型\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('span',[_vm._v(\"\\r\\n        \"+_vm._s(scope.row.type))])]}}])}),_c('el-table-column',{attrs:{\"width\":\"200px\",\"align\":\"center\",\"label\":\"资源名称\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('span',[_vm._v(\"\\r\\n        \"+_vm._s(scope.row.name))])]}}])}),_c('el-table-column',{attrs:{\"width\":\"200px\",\"align\":\"center\",\"label\":\"资源地址\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('span',[_vm._v(\"\\r\\n        \"+_vm._s(scope.row.uri))])]}}])}),_c('el-table-column',{attrs:{\"width\":\"200px\",\"align\":\"center\",\"label\":\"资源请求类型\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('span',[_vm._v(\"\\r\\n        \"+_vm._s(scope.row.method))])]}}])})],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n<el-row>\r\n  <el-col :span=\"24\">\r\n    <el-button type=\"primary\" v-if=\"groupManager_menu\" @click=\"update\">保存</el-button>\r\n  </el-col>\r\n  <el-col :span=\"8\" style='margin-top:15px;'>\r\n    <el-input placeholder=\"输入关键字进行过滤\" v-model=\"filterText\"> </el-input>\r\n    <el-tree class=\"filter-tree\" check-strictly :node-key=\"getTreeNodeKey\" :data=\"treeData\" show-checkbox node-key=\"id\" highlight-current :props=\"defaultProps\" :filter-node-method=\"filterNode\" ref=\"menuTree\" @node-click=\"getNodeData\" default-expand-all>\r\n    </el-tree>\r\n  </el-col>\r\n  <el-col :span=\"16\" style='margin-top:15px;'>\r\n    <el-table ref=\"elementTable\" :data=\"list\" border fit highlight-current-row @select=\"handleSelectionChange\" style=\"width: 100%\">\r\n      <el-table-column v-if=\"groupManager_element\" type=\"selection\" width=\"55\"> </el-table-column>\r\n      <el-table-column width=\"200px\" align=\"center\" label=\"资源编码\"><template slot-scope=\"scope\" >\r\n    <span>\r\n        {{scope.row.code}}</span>\r\n</template>\r\n\r\n</el-table-column>\r\n    <el-table-column width=\"200px\" align=\"center\" label=\"资源类型\"><template slot-scope=\"scope\" >\r\n    <span>\r\n        {{scope.row.type}}</span>\r\n</template>\r\n\r\n</el-table-column>\r\n    <el-table-column width=\"200px\" align=\"center\" label=\"资源名称\"><template slot-scope=\"scope\" >\r\n    <span>\r\n        {{scope.row.name}}</span>\r\n</template>\r\n\r\n</el-table-column>\r\n    <el-table-column width=\"200px\" align=\"center\" label=\"资源地址\"><template slot-scope=\"scope\" >\r\n    <span>\r\n        {{scope.row.uri}}</span>\r\n</template>\r\n</el-table-column>\r\n    <el-table-column width=\"200px\" align=\"center\" label=\"资源请求类型\"><template slot-scope=\"scope\" >\r\n    <span>\r\n        {{scope.row.method}}</span>\r\n</template>\r\n</el-table-column>\r\n  </el-table>\r\n        </el-col>\r\n\r\n    </el-row>\r\n\r\n</template>\r\n<script>\r\nimport {\r\n  fetchTree\r\n} from '@/api/admin/menu/index'\r\nimport {\r\n  page\r\n} from '@/api/admin/element/index'\r\nimport {\r\n  removeElementAuthority,\r\n  addElementAuthority,\r\n  getElementAuthority,\r\n  modifyMenuAuthority,\r\n  getMenuAuthority\r\n} from '@/api/admin/group/index'\r\nimport { mapGetters } from 'vuex'\r\nexport default {\r\n  props: {\r\n    groupId: {\r\n      default: '1'\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n      filterText: '',\r\n      list: null,\r\n      total: null,\r\n      listQuery: {\r\n        name: undefined\r\n      },\r\n      treeData: [],\r\n      defaultProps: {\r\n        children: 'children',\r\n        label: 'title'\r\n      },\r\n      groupManager_menu: false,\r\n      groupManager_element: false\r\n      //   currentId: -1\r\n    }\r\n  },\r\n  watch: {\r\n    filterText (val) {\r\n      this.$refs.menuTree.filter(val)\r\n    }\r\n  },\r\n  created () {\r\n    this.getList()\r\n    this.groupManager_menu = this.hasPermissions(['groupManager:menu'])\r\n    this.groupManager_element = this.hasPermissions(['groupManager:element'])\r\n  },\r\n  computed: {\r\n    ...mapGetters([\r\n      'elements'\r\n    ])\r\n  },\r\n  methods: {\r\n    getList () {\r\n      fetchTree(this.listQuery).then(data => {\r\n        this.treeData = data\r\n        this.initAuthoritys()\r\n      })\r\n    },\r\n    filterNode (value, data) {\r\n      if (!value) return true\r\n      return data.label.indexOf(value) !== -1\r\n    },\r\n    getNodeData (data) {\r\n      this.listQuery.menuId = data.id\r\n      page(this.listQuery).then(response => {\r\n        this.list = response.rows\r\n        getElementAuthority(this.groupId).then(data => {\r\n          const obj = {}\r\n          for (let i = 0; i < this.list.length; i++) {\r\n            obj[this.list[i].id] = this.list[i]\r\n          }\r\n          const toggle = {}\r\n          for (let i = 0; i < data.length; i++) {\r\n            const id = data[i]\r\n            console.log(data[i])\r\n            if (obj[id] !== undefined && toggle[id] === undefined) {\r\n              this.$refs.elementTable.toggleRowSelection(obj[data[i]])\r\n              toggle[id] = true\r\n            }\r\n          }\r\n        })\r\n      })\r\n      this.currentId = data.id\r\n      this.showElement = true\r\n    },\r\n    getTreeNodeKey (node) {\r\n      return node.id\r\n    },\r\n    handleSelectionChange (val, row) {\r\n      let flag = true\r\n      for (let i = 0; i < val.length; i++) {\r\n        if (val[i].id === row.id) {\r\n          addElementAuthority(this.groupId, {\r\n            menuId: this.currentId,\r\n            elementId: row.id\r\n          })\r\n          flag = false\r\n          break\r\n        }\r\n      }\r\n      if (flag) {\r\n        removeElementAuthority(this.groupId, {\r\n          menuId: this.currentId,\r\n          elementId: row.id\r\n        })\r\n      }\r\n    },\r\n    update () {\r\n      this.$emit('closeAuthorityDialog')\r\n      const nodes = this.$refs.menuTree.getCheckedNodes()\r\n      const ids = []\r\n      for (let i = 0; i < nodes.length; i++) {\r\n        ids.push(nodes[i].id)\r\n      }\r\n      modifyMenuAuthority(this.groupId, {\r\n        menuTrees: ids.join()\r\n      }).then(() => {\r\n        this.$notify({\r\n          title: '成功',\r\n          message: '保存成功',\r\n          type: 'success',\r\n          duration: 2000\r\n        })\r\n      })\r\n    },\r\n    initAuthoritys () {\r\n      getMenuAuthority(this.groupId).then(data => {\r\n        const result = []\r\n        for (let i = 0; i < data.length; i++) {\r\n          result.push(data[i].id)\r\n        }\r\n        this.$refs.menuTree.setCheckedKeys(result)\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./groupAuthority.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./groupAuthority.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./groupAuthority.vue?vue&type=template&id=2a543558&\"\nimport script from \"./groupAuthority.vue?vue&type=script&lang=js&\"\nexport * from \"./groupAuthority.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import fetch from '@/plugin/axios'\r\n\r\nexport function page (query) {\r\n  return fetch({\r\n    url: '/api/admin/element/list',\r\n    method: 'get',\r\n    params: query\r\n  })\r\n}\r\n\r\nexport function addObj (obj) {\r\n  return fetch({\r\n    url: '/api/admin/element',\r\n    method: 'post',\r\n    data: obj\r\n  })\r\n}\r\n\r\nexport function getObj (id) {\r\n  return fetch({\r\n    url: '/api/admin/element/' + id,\r\n    method: 'get'\r\n  })\r\n}\r\n\r\nexport function delObj (id) {\r\n  return fetch({\r\n    url: '/api/admin/element/' + id,\r\n    method: 'delete'\r\n  })\r\n}\r\n\r\nexport function putObj (id, obj) {\r\n  return fetch({\r\n    url: '/api/admin/element/' + id,\r\n    method: 'put',\r\n    data: obj\r\n  })\r\n}\r\n"],"sourceRoot":""}